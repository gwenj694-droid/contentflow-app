<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ContentFlow - Social Media Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #c084fc 0%, #1f2937 100%); }
        .card-shadow { box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .platform-card { transition: all 0.3s ease; }
        .platform-card:hover { transform: translateY(-2px); }
        .calendar-day { transition: all 0.2s ease; }
        .calendar-day:hover { background-color: #f3f4f6; }
        .post-item { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .pro-badge { 
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            animation: shimmer 2s infinite;
        }
        @keyframes shimmer {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
        }
        .template-card { 
            transition: all 0.3s ease; 
            cursor: pointer;
        }
        .template-card:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .bulk-row { 
            transition: all 0.2s ease;
        }
        .bulk-row:hover { 
            background-color: #f9fafb;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-white rounded-lg flex items-center justify-center">
                        <span class="text-2xl">üìÖ</span>
                    </div>
                    <h1 class="text-2xl font-bold">ContentFlow</h1>
                    <span class="text-xs bg-white/20 px-2 py-1 rounded-full">Free Version</span>
                </div>
                <div class="flex items-center space-x-4">
                    <button class="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition-colors">
                        Analytics
                    </button>
                    <button onclick="upgradeToPro()" class="pro-badge text-black px-4 py-2 rounded-lg font-bold transition-all hover:scale-105 flex items-center space-x-2">
                        <span>‚≠ê</span>
                        <span>Upgrade to Pro</span>
                    </button>
                    <button class="bg-white text-black hover:bg-gray-100 px-4 py-2 rounded-lg font-medium transition-colors">
                        Settings
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Pro Features Banner -->
    <div class="bg-gradient-to-r from-yellow-400 to-orange-500 text-black py-3">
        <div class="container mx-auto px-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <span class="font-semibold">üöÄ Unlock Pro Features:</span>
                    <span class="text-sm">Unlimited posts ‚Ä¢ Cloud sync ‚Ä¢ Team collaboration ‚Ä¢ Advanced analytics</span>
                </div>
                <button onclick="upgradeToPro()" class="bg-black text-white px-4 py-2 rounded-lg font-medium hover:bg-gray-800 transition-colors">
                    Get Pro Now
                </button>
            </div>
        </div>
    </div>

    <div class="container mx-auto px-6 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Left Panel - Platform Connections & Quick Actions -->
            <div class="lg:col-span-1 space-y-6">
                <!-- Upgrade Card -->
                <div class="bg-gradient-to-br from-yellow-50 to-orange-50 border-2 border-yellow-200 rounded-xl p-6">
                    <div class="text-center">
                        <div class="w-16 h-16 bg-yellow-400 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-2xl">‚≠ê</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Upgrade to Pro</h3>
                        <p class="text-gray-600 text-sm mb-4">Unlock unlimited posts, cloud sync, team features, and advanced analytics</p>
                        <button onclick="upgradeToPro()" class="w-full bg-yellow-400 hover:bg-yellow-500 text-black py-3 px-4 rounded-lg font-bold transition-colors">
                            Get Pro - $9.99/month
                        </button>
                        <p class="text-xs text-gray-500 mt-2">30-day money-back guarantee</p>
                    </div>
                </div>

                <!-- Platform Connections -->
                <div class="bg-white rounded-xl card-shadow p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-xl font-semibold flex items-center">
                            <span class="mr-2">üîó</span>
                            Connected Accounts
                        </h2>
                        <button onclick="openAccountSetup()" class="text-purple-600 hover:text-purple-800 text-sm font-medium">
                            + Add Account
                        </button>
                    </div>
                    
                    <div id="connectedAccounts" class="space-y-3 mb-4">
                        <!-- Connected accounts will be populated here -->
                    </div>
                    
                    <!-- Available Platforms to Connect -->
                    <div class="pt-4 border-t border-gray-200">
                        <h3 class="text-sm font-medium text-gray-600 mb-3">Available Platforms</h3>
                        <div class="space-y-2">
                            <div class="platform-card bg-blue-50 border border-blue-200 rounded-lg p-3 cursor-pointer" onclick="connectPlatform('linkedin')">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-6 h-6 bg-blue-600 rounded flex items-center justify-center text-white font-bold text-xs">in</div>
                                        <span class="text-sm font-medium">LinkedIn</span>
                                    </div>
                                    <span class="text-xs text-blue-600">Connect</span>
                                </div>
                            </div>
                            
                            <div class="platform-card bg-pink-50 border border-pink-200 rounded-lg p-3 cursor-pointer" onclick="connectPlatform('instagram')">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-6 h-6 bg-gradient-to-br from-purple-500 to-pink-500 rounded flex items-center justify-center text-white font-bold text-xs">üì∑</div>
                                        <span class="text-sm font-medium">Instagram</span>
                                    </div>
                                    <span class="text-xs text-pink-600">Connect</span>
                                </div>
                            </div>
                            
                            <div class="platform-card bg-blue-50 border border-blue-200 rounded-lg p-3 cursor-pointer" onclick="connectPlatform('twitter')">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-6 h-6 bg-blue-400 rounded flex items-center justify-center text-white font-bold text-xs">ùïè</div>
                                        <span class="text-sm font-medium">X (Twitter)</span>
                                    </div>
                                    <span class="text-xs text-blue-600">Connect</span>
                                </div>
                            </div>
                            
                            <div class="platform-card bg-black border border-gray-300 rounded-lg p-3 cursor-pointer opacity-50" onclick="showProFeature('TikTok integration')">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-6 h-6 bg-black rounded flex items-center justify-center text-white font-bold text-xs">üéµ</div>
                                        <span class="text-sm font-medium text-white">TikTok</span>
                                    </div>
                                    <span class="text-xs text-yellow-400 font-bold">PRO</span>
                                </div>
                            </div>
                            
                            <div class="platform-card bg-gray-50 border border-gray-200 rounded-lg p-3 cursor-pointer opacity-50" onclick="showProFeature('Facebook integration')">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-6 h-6 bg-blue-600 rounded flex items-center justify-center text-white font-bold text-xs">f</div>
                                        <span class="text-sm font-medium">Facebook</span>
                                    </div>
                                    <span class="text-xs text-yellow-600 font-bold">PRO</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="bg-white rounded-xl card-shadow p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <span class="mr-2">‚ö°</span>
                        Quick Actions
                    </h2>
                    <div class="space-y-3">
                        <button onclick="openCreatePost()" class="w-full bg-purple-400 hover:bg-purple-500 text-black py-3 px-4 rounded-lg font-medium transition-colors flex items-center justify-center space-x-2">
                            <span>‚úèÔ∏è</span>
                            <span>Create New Post</span>
                        </button>
                        <button onclick="openBulkScheduler()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg font-medium transition-colors flex items-center justify-center space-x-2">
                            <span>üìÖ</span>
                            <span>Bulk Schedule</span>
                        </button>
                        <button onclick="openTemplates()" class="w-full bg-orange-600 hover:bg-orange-700 text-white py-3 px-4 rounded-lg font-medium transition-colors flex items-center justify-center space-x-2">
                            <span>üìù</span>
                            <span>Content Templates</span>
                        </button>
                        <button onclick="showTodaysPosts()" class="w-full bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-lg font-medium transition-colors flex items-center justify-center space-x-2">
                            <span>üìã</span>
                            <span>Today's Posts</span>
                        </button>
                        <button onclick="openTeamCollaboration()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white py-3 px-4 rounded-lg font-medium transition-colors flex items-center justify-center space-x-2">
                            <span>üë•</span>
                            <span>Team Collaboration</span>
                        </button>
                        <button onclick="showProFeature('Advanced Analytics')" class="w-full bg-gray-800 hover:bg-black text-white py-3 px-4 rounded-lg font-medium transition-colors flex items-center justify-center space-x-2">
                            <span>üìä</span>
                            <span>View Analytics</span>
                            <span class="text-xs bg-yellow-400 text-black px-2 py-1 rounded-full">PRO</span>
                        </button>
                    </div>
                </div>

                <!-- Today's Scheduled Posts -->
                <div class="bg-white rounded-xl card-shadow p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <span class="mr-2">üïê</span>
                        Today's Schedule
                    </h2>
                    <div id="todaysSchedule" class="space-y-3">
                        <!-- Today's posts will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Center Panel - Calendar & Content Planning -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Calendar View -->
                <div class="bg-white rounded-xl card-shadow p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-xl font-semibold flex items-center">
                            <span class="mr-2">üìÖ</span>
                            Content Calendar
                        </h2>
                        <div class="flex items-center space-x-4">
                            <button onclick="previousMonth()" class="p-2 hover:bg-gray-100 rounded-lg">
                                <span class="text-xl">‚Üê</span>
                            </button>
                            <span id="currentMonth" class="font-semibold text-lg"></span>
                            <button onclick="nextMonth()" class="p-2 hover:bg-gray-100 rounded-lg">
                                <span class="text-xl">‚Üí</span>
                            </button>
                        </div>
                    </div>
                    
                    <div id="calendar" class="grid grid-cols-7 gap-1">
                        <!-- Calendar will be generated here -->
                    </div>
                </div>

                <!-- Scheduled Posts for Selected Date -->
                <div class="bg-white rounded-xl card-shadow p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <span class="mr-2">üìù</span>
                        Posts for <span id="selectedDate" class="text-purple-400 ml-1">Today</span>
                    </h2>
                    <div id="scheduledPosts" class="space-y-4">
                        <!-- Scheduled posts will be shown here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Account Setup Modal -->
    <div id="accountSetupModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-semibold">Connect Account</h3>
                <button onclick="closeAccountSetup()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
            </div>
            
            <form id="accountForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium mb-2">Platform</label>
                    <select id="platformSelect" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-400 focus:border-transparent">
                        <option value="">Select Platform</option>
                        <option value="instagram">Instagram</option>
                        <option value="linkedin">LinkedIn</option>
                        <option value="twitter">X (Twitter)</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2">Account Name/Handle</label>
                    <input type="text" id="accountHandle" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-400 focus:border-transparent" placeholder="@yourusername or Account Name">
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2">Account Type</label>
                    <select id="accountType" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-400 focus:border-transparent">
                        <option value="personal">Personal</option>
                        <option value="business">Business</option>
                        <option value="creator">Creator</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2">Description (Optional)</label>
                    <input type="text" id="accountDescription" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-400 focus:border-transparent" placeholder="e.g., Digital Marketing Account">
                </div>
                
                <div class="flex space-x-4">
                    <button type="button" onclick="saveAccount()" class="flex-1 bg-purple-400 hover:bg-purple-500 text-black py-3 px-6 rounded-lg font-medium transition-colors">
                        Connect Account
                    </button>
                    <button type="button" onclick="closeAccountSetup()" class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Bulk Scheduler Modal -->
    <div id="bulkSchedulerModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-semibold">Bulk Schedule Posts</h3>
                <button onclick="closeBulkScheduler()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
            </div>
            
            <div class="mb-6">
                <div class="flex items-center justify-between mb-4">
                    <p class="text-gray-600">Schedule multiple posts at once. Perfect for planning your content calendar.</p>
                    <button onclick="addBulkRow()" class="bg-purple-400 hover:bg-purple-500 text-black px-4 py-2 rounded-lg font-medium transition-colors">
                        + Add Post
                    </button>
                </div>
                
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                    <div class="flex items-center space-x-2">
                        <span class="text-yellow-600">‚ö†Ô∏è</span>
                        <span class="text-sm text-yellow-800">Free version: Limited to 3 posts in bulk scheduler. <button onclick="upgradeToPro()" class="text-yellow-900 underline font-medium">Upgrade to Pro</button> for unlimited bulk scheduling.</span>
                    </div>
                </div>
            </div>
            
            <div class="overflow-x-auto">
                <table class="w-full border-collapse">
                    <thead>
                        <tr class="bg-gray-50">
                            <th class="border border-gray-200 px-4 py-3 text-left text-sm font-medium text-gray-700">Content</th>
                            <th class="border border-gray-200 px-4 py-3 text-left text-sm font-medium text-gray-700">Date</th>
                            <th class="border border-gray-200 px-4 py-3 text-left text-sm font-medium text-gray-700">Time</th>
                            <th class="border border-gray-200 px-4 py-3 text-left text-sm font-medium text-gray-700">Accounts</th>
                            <th class="border border-gray-200 px-4 py-3 text-left text-sm font-medium text-gray-700">Type</th>
                            <th class="border border-gray-200 px-4 py-3 text-left text-sm font-medium text-gray-700">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="bulkScheduleRows">
                        <!-- Bulk schedule rows will be added here -->
                    </tbody>
                </table>
            </div>
            
            <div class="flex justify-between items-center mt-6">
                <div class="text-sm text-gray-600">
                    <span id="bulkRowCount">0</span> posts ready to schedule
                </div>
                <div class="flex space-x-4">
                    <button onclick="saveBulkSchedule()" class="bg-purple-400 hover:bg-purple-500 text-black py-3 px-6 rounded-lg font-medium transition-colors">
                        Schedule All Posts
                    </button>
                    <button onclick="closeBulkScheduler()" class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Content Templates Modal -->
    <div id="templatesModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-semibold">Content Templates</h3>
                <button onclick="closeTemplates()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
            </div>
            
            <div class="mb-6">
                <div class="flex items-center justify-between mb-4">
                    <p class="text-gray-600">Use pre-made templates to create engaging content faster.</p>
                    <button onclick="createCustomTemplate()" class="bg-purple-400 hover:bg-purple-500 text-black px-4 py-2 rounded-lg font-medium transition-colors">
                        + Create Template
                    </button>
                </div>
                
                <div class="flex space-x-4 mb-6">
                    <button onclick="filterTemplates('all')" class="px-4 py-2 bg-purple-100 text-purple-800 rounded-lg text-sm font-medium">All</button>
                    <button onclick="filterTemplates('marketing')" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200">Marketing</button>
                    <button onclick="filterTemplates('engagement')" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200">Engagement</button>
                    <button onclick="filterTemplates('educational')" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200">Educational</button>
                    <button onclick="filterTemplates('promotional')" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200">Promotional</button>
                </div>
            </div>
            
            <div id="templatesGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Templates will be populated here -->
            </div>
        </div>
    </div>

    <!-- Team Collaboration Modal -->
    <div id="teamModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-semibold">Team Collaboration</h3>
                <button onclick="closeTeamCollaboration()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Team Members -->
                <div>
                    <div class="flex items-center justify-between mb-4">
                        <h4 class="text-lg font-semibold">Team Members</h4>
                        <button onclick="inviteTeamMember()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                            + Invite Member
                        </button>
                    </div>
                    
                    <div id="teamMembers" class="space-y-3">
                        <!-- Team members will be populated here -->
                    </div>
                </div>
                
                <!-- Pending Approvals -->
                <div>
                    <h4 class="text-lg font-semibold mb-4">Pending Approvals</h4>
                    <div id="pendingApprovals" class="space-y-3">
                        <!-- Pending approvals will be populated here -->
                    </div>
                </div>
            </div>
            
            <!-- Team Activity Feed -->
            <div class="mt-8">
                <h4 class="text-lg font-semibold mb-4">Recent Activity</h4>
                <div id="teamActivity" class="bg-gray-50 rounded-lg p-4 max-h-64 overflow-y-auto">
                    <!-- Team activity will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Create/Edit Post Modal -->
    <div id="createPostModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 id="postModalTitle" class="text-2xl font-semibold">Create New Post</h3>
                <button onclick="closeCreatePost()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
            </div>
            
            <!-- Free Version Limitation Notice -->
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                <div class="flex items-center space-x-2">
                    <span class="text-yellow-600">‚ö†Ô∏è</span>
                    <span class="text-sm text-yellow-800">Free version: Limited to 5 posts per month. <button onclick="upgradeToPro()" class="text-yellow-900 underline font-medium">Upgrade to Pro</button> for unlimited posts.</span>
                </div>
            </div>
            
            <form id="postForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium mb-2">Select Accounts</label>
                    <div id="accountSelection" class="grid grid-cols-1 gap-3">
                        <!-- Connected accounts will be populated here -->
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2">Post Content</label>
                    <textarea id="postContent" rows="6" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-400 focus:border-transparent" placeholder="What's on your mind? Share your insights, tips, or inspiration..."></textarea>
                    <div class="text-right text-sm text-gray-500 mt-1">
                        <span id="charCount">0</span> characters
                    </div>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">Schedule Date</label>
                        <input type="date" id="scheduleDate" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-400 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Schedule Time</label>
                        <input type="time" id="scheduleTime" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-400 focus:border-transparent">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2">Post Type</label>
                    <select id="postType" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-400 focus:border-transparent" onchange="toggleImageUpload()">
                        <option value="text">Text Post</option>
                        <option value="image">Image Post</option>
                        <option value="video">Video Post</option>
                        <option value="article">Article/Blog</option>
                        <option value="poll">Poll</option>
                    </select>
                </div>
                
                <!-- Image Upload Section -->
                <div id="imageUploadSection" class="hidden">
                    <label class="block text-sm font-medium mb-2">Upload Image</label>
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-purple-400 transition-colors">
                        <input type="file" id="imageUpload" accept="image/*" class="hidden" onchange="handleImageUpload(event)">
                        <div id="uploadArea" onclick="document.getElementById('imageUpload').click()" class="cursor-pointer">
                            <div class="text-4xl mb-2">üì∏</div>
                            <p class="text-gray-600 mb-2">Click to upload an image</p>
                            <p class="text-sm text-gray-500">PNG, JPG, GIF up to 10MB</p>
                        </div>
                        <div id="imagePreview" class="hidden">
                            <img id="previewImg" class="max-w-full h-48 object-cover rounded-lg mx-auto mb-3" alt="Preview">
                            <div class="flex items-center justify-center space-x-4">
                                <button type="button" onclick="removeImage()" class="text-red-600 hover:text-red-800 text-sm">
                                    Remove Image
                                </button>
                                <button type="button" onclick="document.getElementById('imageUpload').click()" class="text-purple-600 hover:text-purple-800 text-sm">
                                    Change Image
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex space-x-4">
                    <button type="button" onclick="savePost()" id="savePostBtn" class="flex-1 bg-purple-400 hover:bg-purple-500 text-black py-3 px-6 rounded-lg font-medium transition-colors">
                        Schedule Post
                    </button>
                    <button type="button" onclick="closeCreatePost()" class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Pro Feature Modal -->
    <div id="proFeatureModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="text-center">
                <div class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-2xl">‚≠ê</span>
                </div>
                <h3 class="text-xl font-semibold mb-2">Pro Feature</h3>
                <p id="proFeatureText" class="text-gray-600 mb-6">This feature is available in ContentFlow Pro.</p>
                
                <div class="space-y-3 mb-6">
                    <button onclick="upgradeToPro()" class="w-full bg-yellow-400 hover:bg-yellow-500 text-black py-3 px-4 rounded-lg font-bold transition-colors">
                        Upgrade to Pro - $9.99/month
                    </button>
                    <button onclick="closeProFeature()" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-800 py-2 px-4 rounded-lg transition-colors">
                        Maybe Later
                    </button>
                </div>
                
                <p class="text-xs text-gray-500">30-day money-back guarantee</p>
            </div>
        </div>
    </div>

    <!-- Post Now Modal -->
    <div id="postNowModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="text-center">
                <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-2xl">üöÄ</span>
                </div>
                <h3 class="text-xl font-semibold mb-2">Ready to Post!</h3>
                <p class="text-gray-600 mb-6">Your content is ready to be published. Click the account buttons below to post directly.</p>
                
                <div id="postNowAccounts" class="space-y-3 mb-6">
                    <!-- Account post buttons will be generated here -->
                </div>
                
                <button onclick="closePostNow()" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-800 py-2 px-4 rounded-lg transition-colors">
                    Close
                </button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentDate = new Date();
        let selectedDate = new Date();
        let scheduledPosts = JSON.parse(localStorage.getItem('scheduledPosts')) || [];
        let connectedAccounts = JSON.parse(localStorage.getItem('connectedAccounts')) || [];
        let contentTemplates = JSON.parse(localStorage.getItem('contentTemplates')) || getDefaultTemplates();
        let teamMembers = JSON.parse(localStorage.getItem('teamMembers')) || getDefaultTeamMembers();
        let editingPostId = null;
        let bulkRowCounter = 0;
        
        // Your Stripe payment link - replace with your actual link
        const STRIPE_PAYMENT_LINK = 'https://buy.stripe.com/3cI9AS4IO7jK8Hj5gLcjS0g';

        // Default templates
        function getDefaultTemplates() {
            return [
                {
                    id: 1,
                    name: "Monday Motivation",
                    category: "engagement",
                    content: "üåü Monday Motivation üåü\n\nStart your week with purpose! What's one goal you're excited to work on this week?\n\n#MondayMotivation #Goals #Success",
                    type: "text",
                    platforms: ["linkedin", "instagram", "twitter"]
                },
                {
                    id: 2,
                    name: "Behind the Scenes",
                    category: "engagement",
                    content: "üé¨ Behind the scenes at [Your Company]!\n\nHere's what goes into creating [your product/service]. We love sharing our process with you!\n\n#BehindTheScenes #TeamWork #Process",
                    type: "image",
                    platforms: ["instagram", "linkedin"]
                },
                {
                    id: 3,
                    name: "Tip Tuesday",
                    category: "educational",
                    content: "üí° Tip Tuesday! üí°\n\nHere's a quick tip to [solve common problem]:\n\n‚úÖ [Tip 1]\n‚úÖ [Tip 2]\n‚úÖ [Tip 3]\n\nWhich tip will you try first?\n\n#TipTuesday #Tips #Education",
                    type: "text",
                    platforms: ["linkedin", "twitter", "instagram"]
                },
                {
                    id: 4,
                    name: "Product Showcase",
                    category: "promotional",
                    content: "‚ú® Spotlight on [Product Name] ‚ú®\n\n[Brief product description and key benefits]\n\nüîó Learn more: [link]\n\n#Product #Innovation #Quality",
                    type: "image",
                    platforms: ["instagram", "linkedin", "facebook"]
                },
                {
                    id: 5,
                    name: "Customer Success Story",
                    category: "marketing",
                    content: "üéâ Success Story Alert! üéâ\n\n\"[Customer testimonial or success story]\"\n\n- [Customer Name], [Company]\n\nWe're so proud to be part of your journey!\n\n#CustomerSuccess #Testimonial #Results",
                    type: "text",
                    platforms: ["linkedin", "instagram", "twitter"]
                },
                {
                    id: 6,
                    name: "Question of the Day",
                    category: "engagement",
                    content: "ü§î Question of the Day:\n\n[Engaging question related to your industry]\n\nDrop your thoughts in the comments! We love hearing from you.\n\n#QuestionOfTheDay #Community #Discussion",
                    type: "text",
                    platforms: ["linkedin", "instagram", "twitter", "facebook"]
                }
            ];
        }

        // Default team members
        function getDefaultTeamMembers() {
            return [
                {
                    id: 1,
                    name: "You",
                    email: "you@company.com",
                    role: "Admin",
                    avatar: "üë§",
                    status: "active",
                    joinDate: new Date().toISOString()
                }
            ];
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            generateCalendar();
            updateTodaysSchedule();
            updateScheduledPosts();
            updateConnectedAccounts();
            
            // Set default date and time
            const today = new Date();
            document.getElementById('scheduleDate').value = today.toISOString().split('T')[0];
            document.getElementById('scheduleTime').value = '09:00';
            
            // Character counter
            document.getElementById('postContent').addEventListener('input', function() {
                document.getElementById('charCount').textContent = this.value.length;
            });
        });

        // Default templates
        function getDefaultTemplates() {
            return [
                {
                    id: 1,
                    name: "Monday Motivation",
                    category: "engagement",
                    content: "üåü Monday Motivation üåü\n\nStart your week with purpose! What's one goal you're excited to work on this week?\n\n#MondayMotivation #Goals #Success",
                    type: "text",
                    platforms: ["linkedin", "instagram", "twitter"]
                },
                {
                    id: 2,
                    name: "Behind the Scenes",
                    category: "engagement",
                    content: "üé¨ Behind the scenes at [Your Company]!\n\nHere's what goes into creating [your product/service]. We love sharing our process with you!\n\n#BehindTheScenes #TeamWork #Process",
                    type: "image",
                    platforms: ["instagram", "linkedin"]
                },
                {
                    id: 3,
                    name: "Tip Tuesday",
                    category: "educational",
                    content: "üí° Tip Tuesday! üí°\n\nHere's a quick tip to [solve common problem]:\n\n‚úÖ [Tip 1]\n‚úÖ [Tip 2]\n‚úÖ [Tip 3]\n\nWhich tip will you try first?\n\n#TipTuesday #Tips #Education",
                    type: "text",
                    platforms: ["linkedin", "twitter", "instagram"]
                },
                {
                    id: 4,
                    name: "Product Showcase",
                    category: "promotional",
                    content: "‚ú® Spotlight on [Product Name] ‚ú®\n\n[Brief product description and key benefits]\n\nüîó Learn more: [link]\n\n#Product #Innovation #Quality",
                    type: "image",
                    platforms: ["instagram", "linkedin", "facebook"]
                },
                {
                    id: 5,
                    name: "Customer Success Story",
                    category: "marketing",
                    content: "üéâ Success Story Alert! üéâ\n\n\"[Customer testimonial or success story]\"\n\n- [Customer Name], [Company]\n\nWe're so proud to be part of your journey!\n\n#CustomerSuccess #Testimonial #Results",
                    type: "text",
                    platforms: ["linkedin", "instagram", "twitter"]
                },
                {
                    id: 6,
                    name: "Question of the Day",
                    category: "engagement",
                    content: "ü§î Question of the Day:\n\n[Engaging question related to your industry]\n\nDrop your thoughts in the comments! We love hearing from you.\n\n#QuestionOfTheDay #Community #Discussion",
                    type: "text",
                    platforms: ["linkedin", "instagram", "twitter", "facebook"]
                }
            ];
        }

        // Default team members
        function getDefaultTeamMembers() {
            return [
                {
                    id: 1,
                    name: "You",
                    email: "you@company.com",
                    role: "Admin",
                    avatar: "üë§",
                    status: "active",
                    joinDate: new Date().toISOString()
                }
            ];
        }

        // Bulk Scheduler Functions
        function openBulkScheduler() {
            if (connectedAccounts.length === 0) {
                alert('Please connect at least one account before using bulk scheduler.');
                openAccountSetup();
                return;
            }
            
            document.getElementById('bulkSchedulerModal').classList.remove('hidden');
            document.getElementById('bulkSchedulerModal').classList.add('flex');
            
            // Add initial rows
            if (document.getElementById('bulkScheduleRows').children.length === 0) {
                addBulkRow();
                addBulkRow();
                addBulkRow();
            }
        }

        function closeBulkScheduler() {
            document.getElementById('bulkSchedulerModal').classList.add('hidden');
            document.getElementById('bulkSchedulerModal').classList.remove('flex');
            document.getElementById('bulkScheduleRows').innerHTML = '';
            bulkRowCounter = 0;
            updateBulkRowCount();
        }

        function addBulkRow() {
            const freeLimit = 3;
            const currentRows = document.getElementById('bulkScheduleRows').children.length;
            
            if (currentRows >= freeLimit) {
                showProFeature('Unlimited Bulk Scheduling');
                return;
            }
            
            bulkRowCounter++;
            const row = document.createElement('tr');
            row.className = 'bulk-row';
            row.id = `bulkRow${bulkRowCounter}`;
            
            const today = new Date();
            const defaultDate = new Date(today.getTime() + (currentRows * 24 * 60 * 60 * 1000));
            
            row.innerHTML = `
                <td class="border border-gray-200 px-2 py-2">
                    <textarea class="w-full border border-gray-300 rounded px-3 py-2 text-sm resize-none" rows="3" placeholder="Enter your post content..."></textarea>
                </td>
                <td class="border border-gray-200 px-2 py-2">
                    <input type="date" class="w-full border border-gray-300 rounded px-3 py-2 text-sm" value="${defaultDate.toISOString().split('T')[0]}">
                </td>
                <td class="border border-gray-200 px-2 py-2">
                    <input type="time" class="w-full border border-gray-300 rounded px-3 py-2 text-sm" value="09:00">
                </td>
                <td class="border border-gray-200 px-2 py-2">
                    <select class="w-full border border-gray-300 rounded px-3 py-2 text-sm" multiple>
                        ${connectedAccounts.map(account => `
                            <option value="${account.id}">${account.handle} (${account.platform})</option>
                        `).join('')}
                    </select>
                </td>
                <td class="border border-gray-200 px-2 py-2">
                    <select class="w-full border border-gray-300 rounded px-3 py-2 text-sm">
                        <option value="text">Text</option>
                        <option value="image">Image</option>
                        <option value="video">Video</option>
                        <option value="article">Article</option>
                    </select>
                </td>
                <td class="border border-gray-200 px-2 py-2">
                    <button onclick="removeBulkRow('bulkRow${bulkRowCounter}')" class="text-red-600 hover:text-red-800 text-sm">Remove</button>
                </td>
            `;
            
            document.getElementById('bulkScheduleRows').appendChild(row);
            updateBulkRowCount();
        }

        function removeBulkRow(rowId) {
            document.getElementById(rowId).remove();
            updateBulkRowCount();
        }

        function updateBulkRowCount() {
            const count = document.getElementById('bulkScheduleRows').children.length;
            document.getElementById('bulkRowCount').textContent = count;
        }

        function saveBulkSchedule() {
            const rows = document.getElementById('bulkScheduleRows').children;
            let savedCount = 0;
            
            for (let row of rows) {
                const content = row.querySelector('textarea').value.trim();
                const date = row.querySelector('input[type="date"]').value;
                const time = row.querySelector('input[type="time"]').value;
                const accountSelect = row.querySelector('select[multiple]');
                const selectedAccounts = Array.from(accountSelect.selectedOptions).map(option => parseInt(option.value));
                const type = row.querySelector('select:not([multiple])').value;
                
                if (content && date && time && selectedAccounts.length > 0) {
                    const post = {
                        id: Date.now() + savedCount,
                        content,
                        date: date + 'T' + time,
                        type,
                        accounts: selectedAccounts,
                        status: 'scheduled',
                        image: null
                    };
                    
                    scheduledPosts.push(post);
                    savedCount++;
                }
            }
            
            if (savedCount > 0) {
                localStorage.setItem('scheduledPosts', JSON.stringify(scheduledPosts));
                closeBulkScheduler();
                generateCalendar();
                updateScheduledPosts();
                updateTodaysSchedule();
                alert(`${savedCount} posts scheduled successfully!`);
            } else {
                alert('Please fill in all required fields for at least one post.');
            }
        }

        // Content Templates Functions
        function openTemplates() {
            document.getElementById('templatesModal').classList.remove('hidden');
            document.getElementById('templatesModal').classList.add('flex');
            displayTemplates();
        }

        function closeTemplates() {
            document.getElementById('templatesModal').classList.add('hidden');
            document.getElementById('templatesModal').classList.remove('flex');
        }

        function displayTemplates(filter = 'all') {
            const container = document.getElementById('templatesGrid');
            const filteredTemplates = filter === 'all' ? contentTemplates : contentTemplates.filter(t => t.category === filter);
            
            container.innerHTML = filteredTemplates.map(template => `
                <div class="template-card bg-white border border-gray-200 rounded-lg p-6 hover:shadow-lg transition-all" onclick="useTemplate(${template.id})">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-lg">${template.name}</h4>
                        <span class="px-2 py-1 bg-${getCategoryColor(template.category)}-100 text-${getCategoryColor(template.category)}-800 text-xs rounded-full">
                            ${template.category}
                        </span>
                    </div>
                    <p class="text-gray-600 text-sm mb-4 line-clamp-3">${template.content.substring(0, 120)}...</p>
                    <div class="flex items-center justify-between">
                        <div class="flex space-x-1">
                            ${template.platforms.map(platform => `
                                <span class="text-xs">${getPlatformIcon(platform)}</span>
                            `).join('')}
                        </div>
                        <button class="text-purple-600 hover:text-purple-800 text-sm font-medium">Use Template</button>
                    </div>
                </div>
            `).join('');
        }

        function filterTemplates(category) {
            // Update active filter button
            document.querySelectorAll('[onclick^="filterTemplates"]').forEach(btn => {
                btn.className = 'px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200';
            });
            event.target.className = 'px-4 py-2 bg-purple-100 text-purple-800 rounded-lg text-sm font-medium';
            
            displayTemplates(category);
        }

        function useTemplate(templateId) {
            const template = contentTemplates.find(t => t.id === templateId);
            if (!template) return;
            
            closeTemplates();
            openCreatePost();
            
            // Populate form with template data
            setTimeout(() => {
                document.getElementById('postContent').value = template.content;
                document.getElementById('postType').value = template.type;
                document.getElementById('charCount').textContent = template.content.length;
                
                if (template.type === 'image' || template.type === 'video') {
                    document.getElementById('imageUploadSection').classList.remove('hidden');
                }
            }, 100);
        }

        function createCustomTemplate() {
            const name = prompt('Enter template name:');
            if (!name) return;
            
            const content = prompt('Enter template content:');
            if (!content) return;
            
            const category = prompt('Enter category (marketing, engagement, educational, promotional):') || 'marketing';
            
            const template = {
                id: Date.now(),
                name,
                content,
                category,
                type: 'text',
                platforms: ['instagram', 'linkedin', 'twitter']
            };
            
            contentTemplates.push(template);
            localStorage.setItem('contentTemplates', JSON.stringify(contentTemplates));
            displayTemplates();
            
            alert('Custom template created successfully!');
        }

        function getCategoryColor(category) {
            const colors = {
                marketing: 'blue',
                engagement: 'green',
                educational: 'yellow',
                promotional: 'purple'
            };
            return colors[category] || 'gray';
        }

        // Team Collaboration Functions
        function openTeamCollaboration() {
            document.getElementById('teamModal').classList.remove('hidden');
            document.getElementById('teamModal').classList.add('flex');
            displayTeamMembers();
            displayPendingApprovals();
            displayTeamActivity();
        }

        function closeTeamCollaboration() {
            document.getElementById('teamModal').classList.add('hidden');
            document.getElementById('teamModal').classList.remove('flex');
        }

        function displayTeamMembers() {
            const container = document.getElementById('teamMembers');
            
            container.innerHTML = teamMembers.map(member => `
                <div class="flex items-center justify-between p-4 border border-gray-200 rounded-lg">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center">
                            <span class="text-lg">${member.avatar}</span>
                        </div>
                        <div>
                            <div class="font-medium">${member.name}</div>
                            <div class="text-sm text-gray-600">${member.email}</div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="px-2 py-1 bg-${member.role === 'Admin' ? 'purple' : 'gray'}-100 text-${member.role === 'Admin' ? 'purple' : 'gray'}-800 text-xs rounded-full">
                            ${member.role}
                        </span>
                        ${member.id !== 1 ? `
                            <button onclick="removeTeamMember(${member.id})" class="text-red-600 hover:text-red-800 text-sm">Remove</button>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        function displayPendingApprovals() {
            const container = document.getElementById('pendingApprovals');
            
            // Sample pending approvals
            const pendingApprovals = [
                {
                    id: 1,
                    postContent: "Exciting news! We're launching our new product next week...",
                    submittedBy: "Sarah Johnson",
                    submittedAt: "2 hours ago",
                    platform: "LinkedIn"
                },
                {
                    id: 2,
                    postContent: "Behind the scenes at our office today! Check out our team...",
                    submittedBy: "Mike Chen",
                    submittedAt: "5 hours ago",
                    platform: "Instagram"
                }
            ];
            
            if (pendingApprovals.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-sm">No pending approvals</p>';
                return;
            }
            
            container.innerHTML = pendingApprovals.map(approval => `
                <div class="border border-gray-200 rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-sm font-medium">${approval.submittedBy}</span>
                        <span class="text-xs text-gray-500">${approval.submittedAt}</span>
                    </div>
                    <p class="text-sm text-gray-700 mb-3">${approval.postContent.substring(0, 80)}...</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">${approval.platform}</span>
                        <div class="flex space-x-2">
                            <button onclick="approvePost(${approval.id})" class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-xs">Approve</button>
                            <button onclick="rejectPost(${approval.id})" class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-xs">Reject</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function displayTeamActivity() {
            const container = document.getElementById('teamActivity');
            
            // Sample team activity
            const activities = [
                { user: "You", action: "scheduled a post", time: "10 minutes ago", icon: "üìÖ" },
                { user: "Sarah Johnson", action: "submitted a post for approval", time: "2 hours ago", icon: "üìù" },
                { user: "Mike Chen", action: "connected Instagram account", time: "1 day ago", icon: "üîó" },
                { user: "You", action: "created a new template", time: "2 days ago", icon: "üìã" }
            ];
            
            container.innerHTML = activities.map(activity => `
                <div class="flex items-center space-x-3 py-2">
                    <span class="text-lg">${activity.icon}</span>
                    <div class="flex-1">
                        <span class="font-medium">${activity.user}</span>
                        <span class="text-gray-600"> ${activity.action}</span>
                    </div>
                    <span class="text-xs text-gray-500">${activity.time}</span>
                </div>
            `).join('');
        }

        function inviteTeamMember() {
            const email = prompt('Enter team member email:');
            if (!email) return;
            
            const name = prompt('Enter team member name:');
            if (!name) return;
            
            const role = prompt('Enter role (Editor, Viewer):') || 'Editor';
            
            const member = {
                id: Date.now(),
                name,
                email,
                role,
                avatar: 'üë§',
                status: 'pending',
                joinDate: new Date().toISOString()
            };
            
            teamMembers.push(member);
            localStorage.setItem('teamMembers', JSON.stringify(teamMembers));
            displayTeamMembers();
            
            alert(`Invitation sent to ${email}!`);
        }

        function removeTeamMember(memberId) {
            if (confirm('Are you sure you want to remove this team member?')) {
                teamMembers = teamMembers.filter(member => member.id !== memberId);
                localStorage.setItem('teamMembers', JSON.stringify(teamMembers));
                displayTeamMembers();
            }
        }

        function approvePost(approvalId) {
            alert('Post approved and scheduled!');
            displayPendingApprovals();
        }

        function rejectPost(approvalId) {
            const reason = prompt('Reason for rejection (optional):');
            alert('Post rejected. Feedback sent to team member.');
            displayPendingApprovals();
        }

        // Account Management Functions
        function openAccountSetup() {
            document.getElementById('accountSetupModal').classList.remove('hidden');
            document.getElementById('accountSetupModal').classList.add('flex');
        }

        function closeAccountSetup() {
            document.getElementById('accountSetupModal').classList.add('hidden');
            document.getElementById('accountSetupModal').classList.remove('flex');
            document.getElementById('accountForm').reset();
        }

        function saveAccount() {
            const platform = document.getElementById('platformSelect').value;
            const handle = document.getElementById('accountHandle').value;
            const type = document.getElementById('accountType').value;
            const description = document.getElementById('accountDescription').value;
            
            if (!platform || !handle) {
                alert('Please fill in platform and account handle.');
                return;
            }
            
            const account = {
                id: Date.now(),
                platform,
                handle: handle.startsWith('@') ? handle : '@' + handle,
                type,
                description,
                connected: true,
                dateAdded: new Date().toISOString()
            };
            
            connectedAccounts.push(account);
            localStorage.setItem('connectedAccounts', JSON.stringify(connectedAccounts));
            
            closeAccountSetup();
            updateConnectedAccounts();
            updateAccountSelection();
            
            alert(`${platform.charAt(0).toUpperCase() + platform.slice(1)} account connected successfully!`);
        }

        function updateConnectedAccounts() {
            const container = document.getElementById('connectedAccounts');
            
            if (connectedAccounts.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-sm">No accounts connected yet. Click "Add Account" to get started.</p>';
                return;
            }
            
            container.innerHTML = connectedAccounts.map(account => `
                <div class="platform-card bg-${getPlatformColor(account.platform)}-50 border border-${getPlatformColor(account.platform)}-200 rounded-lg p-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-${getPlatformColor(account.platform)}-600 rounded flex items-center justify-center text-white font-bold text-sm">
                                ${getPlatformIcon(account.platform)}
                            </div>
                            <div>
                                <div class="font-medium">${account.handle}</div>
                                <div class="text-xs text-gray-600">${account.description || account.type}</div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button onclick="removeAccount(${account.id})" class="text-red-600 hover:text-red-800 text-xs">
                                Remove
                            </button>
                            <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function removeAccount(accountId) {
            if (confirm('Are you sure you want to remove this account?')) {
                connectedAccounts = connectedAccounts.filter(account => account.id !== accountId);
                localStorage.setItem('connectedAccounts', JSON.stringify(connectedAccounts));
                updateConnectedAccounts();
                updateAccountSelection();
            }
        }

        function updateAccountSelection() {
            const container = document.getElementById('accountSelection');
            
            if (connectedAccounts.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-sm">No accounts connected. <button onclick="openAccountSetup()" class="text-purple-600 underline">Add an account</button> to get started.</p>';
                return;
            }
            
            container.innerHTML = connectedAccounts.map(account => `
                <label class="flex items-center space-x-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50">
                    <input type="checkbox" name="selectedAccounts" value="${account.id}" class="rounded">
                    <div class="w-6 h-6 bg-${getPlatformColor(account.platform)}-600 rounded flex items-center justify-center text-white font-bold text-xs">
                        ${getPlatformIcon(account.platform)}
                    </div>
                    <div class="flex-1">
                        <div class="font-medium text-sm">${account.handle}</div>
                        <div class="text-xs text-gray-600">${account.platform.charAt(0).toUpperCase() + account.platform.slice(1)} ‚Ä¢ ${account.description || account.type}</div>
                    </div>
                </label>
            `).join('');
        }

        function connectPlatform(platform) {
            document.getElementById('platformSelect').value = platform;
            openAccountSetup();
        }

        // Payment and Pro Features
        function upgradeToPro() {
            window.open(STRIPE_PAYMENT_LINK, '_blank');
        }

        function showProFeature(featureName) {
            document.getElementById('proFeatureText').textContent = `${featureName} is available in ContentFlow Pro. Upgrade to unlock unlimited posts, cloud sync, team collaboration, and advanced analytics.`;
            document.getElementById('proFeatureModal').classList.remove('hidden');
            document.getElementById('proFeatureModal').classList.add('flex');
        }

        function closeProFeature() {
            document.getElementById('proFeatureModal').classList.add('hidden');
            document.getElementById('proFeatureModal').classList.remove('flex');
        }

        // Bulk Scheduler Functions
        function openBulkScheduler() {
            if (connectedAccounts.length === 0) {
                alert('Please connect at least one account before using bulk scheduler.');
                openAccountSetup();
                return;
            }
            
            document.getElementById('bulkSchedulerModal').classList.remove('hidden');
            document.getElementById('bulkSchedulerModal').classList.add('flex');
            
            // Add initial rows
            if (document.getElementById('bulkScheduleRows').children.length === 0) {
                addBulkRow();
                addBulkRow();
                addBulkRow();
            }
        }

        function closeBulkScheduler() {
            document.getElementById('bulkSchedulerModal').classList.add('hidden');
            document.getElementById('bulkSchedulerModal').classList.remove('flex');
            document.getElementById('bulkScheduleRows').innerHTML = '';
            bulkRowCounter = 0;
            updateBulkRowCount();
        }

        function addBulkRow() {
            const freeLimit = 3;
            const currentRows = document.getElementById('bulkScheduleRows').children.length;
            
            if (currentRows >= freeLimit) {
                showProFeature('Unlimited Bulk Scheduling');
                return;
            }
            
            bulkRowCounter++;
            const row = document.createElement('tr');
            row.className = 'bulk-row';
            row.id = `bulkRow${bulkRowCounter}`;
            
            const today = new Date();
            const defaultDate = new Date(today.getTime() + (currentRows * 24 * 60 * 60 * 1000));
            
            row.innerHTML = `
                <td class="border border-gray-200 px-2 py-2">
                    <textarea class="w-full border border-gray-300 rounded px-3 py-2 text-sm resize-none" rows="3" placeholder="Enter your post content..."></textarea>
                </td>
                <td class="border border-gray-200 px-2 py-2">
                    <input type="date" class="w-full border border-gray-300 rounded px-3 py-2 text-sm" value="${defaultDate.toISOString().split('T')[0]}">
                </td>
                <td class="border border-gray-200 px-2 py-2">
                    <input type="time" class="w-full border border-gray-300 rounded px-3 py-2 text-sm" value="09:00">
                </td>
                <td class="border border-gray-200 px-2 py-2">
                    <select class="w-full border border-gray-300 rounded px-3 py-2 text-sm" multiple>
                        ${connectedAccounts.map(account => `
                            <option value="${account.id}">${account.handle} (${account.platform})</option>
                        `).join('')}
                    </select>
                </td>
                <td class="border border-gray-200 px-2 py-2">
                    <select class="w-full border border-gray-300 rounded px-3 py-2 text-sm">
                        <option value="text">Text</option>
                        <option value="image">Image</option>
                        <option value="video">Video</option>
                        <option value="article">Article</option>
                    </select>
                </td>
                <td class="border border-gray-200 px-2 py-2">
                    <button onclick="removeBulkRow('bulkRow${bulkRowCounter}')" class="text-red-600 hover:text-red-800 text-sm">Remove</button>
                </td>
            `;
            
            document.getElementById('bulkScheduleRows').appendChild(row);
            updateBulkRowCount();
        }

        function removeBulkRow(rowId) {
            document.getElementById(rowId).remove();
            updateBulkRowCount();
        }

        function updateBulkRowCount() {
            const count = document.getElementById('bulkScheduleRows').children.length;
            document.getElementById('bulkRowCount').textContent = count;
        }

        function saveBulkSchedule() {
            const rows = document.getElementById('bulkScheduleRows').children;
            let savedCount = 0;
            
            for (let row of rows) {
                const content = row.querySelector('textarea').value.trim();
                const date = row.querySelector('input[type="date"]').value;
                const time = row.querySelector('input[type="time"]').value;
                const accountSelect = row.querySelector('select[multiple]');
                const selectedAccounts = Array.from(accountSelect.selectedOptions).map(option => parseInt(option.value));
                const type = row.querySelector('select:not([multiple])').value;
                
                if (content && date && time && selectedAccounts.length > 0) {
                    const post = {
                        id: Date.now() + savedCount,
                        content,
                        date: date + 'T' + time,
                        type,
                        accounts: selectedAccounts,
                        status: 'scheduled',
                        image: null
                    };
                    
                    scheduledPosts.push(post);
                    savedCount++;
                }
            }
            
            if (savedCount > 0) {
                localStorage.setItem('scheduledPosts', JSON.stringify(scheduledPosts));
                closeBulkScheduler();
                generateCalendar();
                updateScheduledPosts();
                updateTodaysSchedule();
                alert(`${savedCount} posts scheduled successfully!`);
            } else {
                alert('Please fill in all required fields for at least one post.');
            }
        }

        // Content Templates Functions
        function openTemplates() {
            document.getElementById('templatesModal').classList.remove('hidden');
            document.getElementById('templatesModal').classList.add('flex');
            displayTemplates();
        }

        function closeTemplates() {
            document.getElementById('templatesModal').classList.add('hidden');
            document.getElementById('templatesModal').classList.remove('flex');
        }

        function displayTemplates(filter = 'all') {
            const container = document.getElementById('templatesGrid');
            const filteredTemplates = filter === 'all' ? contentTemplates : contentTemplates.filter(t => t.category === filter);
            
            container.innerHTML = filteredTemplates.map(template => `
                <div class="template-card bg-white border border-gray-200 rounded-lg p-6 hover:shadow-lg transition-all" onclick="useTemplate(${template.id})">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-lg">${template.name}</h4>
                        <span class="px-2 py-1 bg-${getCategoryColor(template.category)}-100 text-${getCategoryColor(template.category)}-800 text-xs rounded-full">
                            ${template.category}
                        </span>
                    </div>
                    <p class="text-gray-600 text-sm mb-4 line-clamp-3">${template.content.substring(0, 120)}...</p>
                    <div class="flex items-center justify-between">
                        <div class="flex space-x-1">
                            ${template.platforms.map(platform => `
                                <span class="text-xs">${getPlatformIcon(platform)}</span>
                            `).join('')}
                        </div>
                        <button class="text-purple-600 hover:text-purple-800 text-sm font-medium">Use Template</button>
                    </div>
                </div>
            `).join('');
        }

        function filterTemplates(category) {
            // Update active filter button
            document.querySelectorAll('[onclick^="filterTemplates"]').forEach(btn => {
                btn.className = 'px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200';
            });
            event.target.className = 'px-4 py-2 bg-purple-100 text-purple-800 rounded-lg text-sm font-medium';
            
            displayTemplates(category);
        }

        function useTemplate(templateId) {
            const template = contentTemplates.find(t => t.id === templateId);
            if (!template) return;
            
            closeTemplates();
            openCreatePost();
            
            // Populate form with template data
            setTimeout(() => {
                document.getElementById('postContent').value = template.content;
                document.getElementById('postType').value = template.type;
                document.getElementById('charCount').textContent = template.content.length;
                
                if (template.type === 'image' || template.type === 'video') {
                    document.getElementById('imageUploadSection').classList.remove('hidden');
                }
            }, 100);
        }

        function createCustomTemplate() {
            const name = prompt('Enter template name:');
            if (!name) return;
            
            const content = prompt('Enter template content:');
            if (!content) return;
            
            const category = prompt('Enter category (marketing, engagement, educational, promotional):') || 'marketing';
            
            const template = {
                id: Date.now(),
                name,
                content,
                category,
                type: 'text',
                platforms: ['instagram', 'linkedin', 'twitter']
            };
            
            contentTemplates.push(template);
            localStorage.setItem('contentTemplates', JSON.stringify(contentTemplates));
            displayTemplates();
            
            alert('Custom template created successfully!');
        }

        function getCategoryColor(category) {
            const colors = {
                marketing: 'blue',
                engagement: 'green',
                educational: 'yellow',
                promotional: 'purple'
            };
            return colors[category] || 'gray';
        }

        // Team Collaboration Functions
        function openTeamCollaboration() {
            document.getElementById('teamModal').classList.remove('hidden');
            document.getElementById('teamModal').classList.add('flex');
            displayTeamMembers();
            displayPendingApprovals();
            displayTeamActivity();
        }

        function closeTeamCollaboration() {
            document.getElementById('teamModal').classList.add('hidden');
            document.getElementById('teamModal').classList.remove('flex');
        }

        function displayTeamMembers() {
            const container = document.getElementById('teamMembers');
            
            container.innerHTML = teamMembers.map(member => `
                <div class="flex items-center justify-between p-4 border border-gray-200 rounded-lg">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center">
                            <span class="text-lg">${member.avatar}</span>
                        </div>
                        <div>
                            <div class="font-medium">${member.name}</div>
                            <div class="text-sm text-gray-600">${member.email}</div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="px-2 py-1 bg-${member.role === 'Admin' ? 'purple' : 'gray'}-100 text-${member.role === 'Admin' ? 'purple' : 'gray'}-800 text-xs rounded-full">
                            ${member.role}
                        </span>
                        ${member.id !== 1 ? `
                            <button onclick="removeTeamMember(${member.id})" class="text-red-600 hover:text-red-800 text-sm">Remove</button>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        function displayPendingApprovals() {
            const container = document.getElementById('pendingApprovals');
            
            // Sample pending approvals
            const pendingApprovals = [
                {
                    id: 1,
                    postContent: "Exciting news! We're launching our new product next week...",
                    submittedBy: "Sarah Johnson",
                    submittedAt: "2 hours ago",
                    platform: "LinkedIn"
                },
                {
                    id: 2,
                    postContent: "Behind the scenes at our office today! Check out our team...",
                    submittedBy: "Mike Chen",
                    submittedAt: "5 hours ago",
                    platform: "Instagram"
                }
            ];
            
            if (pendingApprovals.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-sm">No pending approvals</p>';
                return;
            }
            
            container.innerHTML = pendingApprovals.map(approval => `
                <div class="border border-gray-200 rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-sm font-medium">${approval.submittedBy}</span>
                        <span class="text-xs text-gray-500">${approval.submittedAt}</span>
                    </div>
                    <p class="text-sm text-gray-700 mb-3">${approval.postContent.substring(0, 80)}...</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">${approval.platform}</span>
                        <div class="flex space-x-2">
                            <button onclick="approvePost(${approval.id})" class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-xs">Approve</button>
                            <button onclick="rejectPost(${approval.id})" class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-xs">Reject</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function displayTeamActivity() {
            const container = document.getElementById('teamActivity');
            
            // Sample team activity
            const activities = [
                { user: "You", action: "scheduled a post", time: "10 minutes ago", icon: "üìÖ" },
                { user: "Sarah Johnson", action: "submitted a post for approval", time: "2 hours ago", icon: "üìù" },
                { user: "Mike Chen", action: "connected Instagram account", time: "1 day ago", icon: "üîó" },
                { user: "You", action: "created a new template", time: "2 days ago", icon: "üìã" }
            ];
            
            container.innerHTML = activities.map(activity => `
                <div class="flex items-center space-x-3 py-2">
                    <span class="text-lg">${activity.icon}</span>
                    <div class="flex-1">
                        <span class="font-medium">${activity.user}</span>
                        <span class="text-gray-600"> ${activity.action}</span>
                    </div>
                    <span class="text-xs text-gray-500">${activity.time}</span>
                </div>
            `).join('');
        }

        function inviteTeamMember() {
            const email = prompt('Enter team member email:');
            if (!email) return;
            
            const name = prompt('Enter team member name:');
            if (!name) return;
            
            const role = prompt('Enter role (Editor, Viewer):') || 'Editor';
            
            const member = {
                id: Date.now(),
                name,
                email,
                role,
                avatar: 'üë§',
                status: 'pending',
                joinDate: new Date().toISOString()
            };
            
            teamMembers.push(member);
            localStorage.setItem('teamMembers', JSON.stringify(teamMembers));
            displayTeamMembers();
            
            alert(`Invitation sent to ${email}!`);
        }

        function removeTeamMember(memberId) {
            if (confirm('Are you sure you want to remove this team member?')) {
                teamMembers = teamMembers.filter(member => member.id !== memberId);
                localStorage.setItem('teamMembers', JSON.stringify(teamMembers));
                displayTeamMembers();
            }
        }

        function approvePost(approvalId) {
            alert('Post approved and scheduled!');
            displayPendingApprovals();
        }

        function rejectPost(approvalId) {
            const reason = prompt('Reason for rejection (optional):');
            alert('Post rejected. Feedback sent to team member.');
            displayPendingApprovals();
        }

        // Calendar functions
        function generateCalendar() {
            const calendar = document.getElementById('calendar');
            const monthYear = document.getElementById('currentMonth');
            
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            monthYear.textContent = new Date(year, month).toLocaleDateString('en-US', { 
                month: 'long', 
                year: 'numeric' 
            });
            
            calendar.innerHTML = '';
            
            // Day headers
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            days.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'text-center font-medium text-gray-600 py-2';
                dayHeader.textContent = day;
                calendar.appendChild(dayHeader);
            });
            
            // Get first day of month and number of days
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            // Empty cells for days before month starts
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day p-2';
                calendar.appendChild(emptyDay);
            }
            
            // Days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                const dayDate = new Date(year, month, day);
                const isToday = dayDate.toDateString() === new Date().toDateString();
                const isSelected = dayDate.toDateString() === selectedDate.toDateString();
                const dayPosts = scheduledPosts.filter(post => 
                    new Date(post.date).toDateString() === dayDate.toDateString()
                );
                
                dayElement.className = `calendar-day p-2 cursor-pointer rounded-lg min-h-[120px] border ${
                    isToday ? 'bg-blue-50 border-blue-300 text-blue-800' : 'bg-white border-gray-200'
                } ${
                    isSelected ? 'ring-2 ring-purple-400 bg-purple-50' : ''
                } hover:bg-gray-50 transition-all`;
                
                dayElement.onclick = () => selectDate(dayDate);
                
                // Day number
                const dayNumber = document.createElement('div');
                dayNumber.className = `text-sm font-semibold mb-1 ${isToday ? 'text-blue-800' : 'text-gray-700'}`;
                dayNumber.textContent = day;
                dayElement.appendChild(dayNumber);
                
                // Posts for this day
                const postsContainer = document.createElement('div');
                postsContainer.className = 'space-y-1';
                
                dayPosts.slice(0, 3).forEach(post => {
                    const postElement = document.createElement('div');
                    postElement.className = 'text-xs p-1 rounded text-white truncate cursor-pointer';
                    
                    // Color based on first account's platform
                    const firstAccountId = post.accounts[0];
                    const firstAccount = connectedAccounts.find(acc => acc.id == firstAccountId);
                    const platform = firstAccount ? firstAccount.platform : 'gray';
                    
                    const platformColors = {
                        linkedin: 'bg-blue-500',
                        instagram: 'bg-pink-500',
                        twitter: 'bg-blue-400',
                        tiktok: 'bg-black',
                        facebook: 'bg-blue-600'
                    };
                    
                    postElement.className += ` ${platformColors[platform] || 'bg-gray-500'}`;
                    
                    // Show time and truncated content
                    const time = new Date(post.date).toLocaleTimeString('en-US', { 
                        hour: '2-digit', 
                        minute: '2-digit',
                        hour12: false
                    });
                    
                    postElement.innerHTML = `
                        <div class="font-medium">${time}</div>
                        <div class="truncate">${post.content.substring(0, 30)}...</div>
                        <div class="flex space-x-1 mt-1">
                            ${post.accounts.map(accountId => {
                                const account = connectedAccounts.find(acc => acc.id == accountId);
                                return account ? getPlatformIcon(account.platform) : 'üì±';
                            }).join(' ')}
                        </div>
                    `;
                    
                    postElement.onclick = (e) => {
                        e.stopPropagation();
                        selectDate(dayDate);
                        if (isToday(post.date)) {
                            postNow(post.id);
                        }
                    };
                    
                    postsContainer.appendChild(postElement);
                });
                
                // Show "more" indicator if there are additional posts
                if (dayPosts.length > 3) {
                    const moreElement = document.createElement('div');
                    moreElement.className = 'text-xs text-gray-500 font-medium text-center';
                    moreElement.textContent = `+${dayPosts.length - 3} more`;
                    postsContainer.appendChild(moreElement);
                }
                
                dayElement.appendChild(postsContainer);
                calendar.appendChild(dayElement);
            }
        }

        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            generateCalendar();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            generateCalendar();
        }

        function selectDate(date) {
            selectedDate = date;
            document.getElementById('selectedDate').textContent = date.toLocaleDateString();
            generateCalendar();
            updateScheduledPosts();
        }

        // Post management functions
        function openCreatePost() {
            if (connectedAccounts.length === 0) {
                alert('Please connect at least one account before creating a post.');
                openAccountSetup();
                return;
            }
            
            // Check free version limit
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            const monthlyPosts = scheduledPosts.filter(post => {
                const postDate = new Date(post.date);
                return postDate.getMonth() === currentMonth && postDate.getFullYear() === currentYear;
            });
            
            if (monthlyPosts.length >= 5) {
                showProFeature('Unlimited Posts');
                return;
            }
            
            editingPostId = null;
            document.getElementById('postModalTitle').textContent = 'Create New Post';
            document.getElementById('savePostBtn').textContent = 'Schedule Post';
            updateAccountSelection();
            document.getElementById('createPostModal').classList.remove('hidden');
            document.getElementById('createPostModal').classList.add('flex');
        }

        function editPost(postId) {
            const post = scheduledPosts.find(p => p.id === postId);
            if (!post) return;
            
            editingPostId = postId;
            document.getElementById('postModalTitle').textContent = 'Edit Post';
            document.getElementById('savePostBtn').textContent = 'Update Post';
            
            // Populate form with existing data
            document.getElementById('postContent').value = post.content;
            document.getElementById('scheduleDate').value = post.date.split('T')[0];
            document.getElementById('scheduleTime').value = post.date.split('T')[1];
            document.getElementById('postType').value = post.type;
            document.getElementById('charCount').textContent = post.content.length;
            
            if (post.image) {
                document.getElementById('previewImg').src = post.image;
                document.getElementById('uploadArea').classList.add('hidden');
                document.getElementById('imagePreview').classList.remove('hidden');
            }
            
            if (post.type === 'image' || post.type === 'video') {
                document.getElementById('imageUploadSection').classList.remove('hidden');
            }
            
            updateAccountSelection();
            
            // Check the accounts that were selected for this post
            setTimeout(() => {
                post.accounts.forEach(accountId => {
                    const checkbox = document.querySelector(`input[name="selectedAccounts"][value="${accountId}"]`);
                    if (checkbox) checkbox.checked = true;
                });
            }, 100);
            
            document.getElementById('createPostModal').classList.remove('hidden');
            document.getElementById('createPostModal').classList.add('flex');
        }

        function closeCreatePost() {
            document.getElementById('createPostModal').classList.add('hidden');
            document.getElementById('createPostModal').classList.remove('flex');
            document.getElementById('postForm').reset();
            document.getElementById('charCount').textContent = '0';
            document.getElementById('imageUploadSection').classList.add('hidden');
            removeImage();
            editingPostId = null;
        }

        function savePost() {
            const content = document.getElementById('postContent').value;
            const date = document.getElementById('scheduleDate').value;
            const time = document.getElementById('scheduleTime').value;
            const type = document.getElementById('postType').value;
            const selectedAccounts = Array.from(document.querySelectorAll('input[name="selectedAccounts"]:checked'))
                .map(cb => parseInt(cb.value));
            const imageData = document.getElementById('previewImg').src;
            
            if (!content || !date || !time || selectedAccounts.length === 0) {
                alert('Please fill in all required fields and select at least one account.');
                return;
            }
            
            const postData = {
                content,
                date: date + 'T' + time,
                type,
                accounts: selectedAccounts,
                status: 'scheduled',
                image: type === 'image' && imageData && imageData !== window.location.href ? imageData : null
            };
            
            if (editingPostId) {
                // Update existing post
                const postIndex = scheduledPosts.findIndex(p => p.id === editingPostId);
                if (postIndex !== -1) {
                    scheduledPosts[postIndex] = { ...scheduledPosts[postIndex], ...postData };
                }
            } else {
                // Create new post
                const post = {
                    id: Date.now(),
                    ...postData
                };
                scheduledPosts.push(post);
            }
            
            localStorage.setItem('scheduledPosts', JSON.stringify(scheduledPosts));
            
            closeCreatePost();
            generateCalendar();
            updateScheduledPosts();
            updateTodaysSchedule();
            
            alert(editingPostId ? 'Post updated successfully!' : 'Post scheduled successfully!');
        }

        function toggleImageUpload() {
            const postType = document.getElementById('postType').value;
            const imageSection = document.getElementById('imageUploadSection');
            
            if (postType === 'image' || postType === 'video') {
                imageSection.classList.remove('hidden');
            } else {
                imageSection.classList.add('hidden');
                removeImage();
            }
        }

        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Check file size (10MB limit)
            if (file.size > 10 * 1024 * 1024) {
                alert('File size must be less than 10MB');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const previewImg = document.getElementById('previewImg');
                const uploadArea = document.getElementById('uploadArea');
                const imagePreview = document.getElementById('imagePreview');
                
                previewImg.src = e.target.result;
                uploadArea.classList.add('hidden');
                imagePreview.classList.remove('hidden');
            };
            reader.readAsDataURL(file);
        }

        function removeImage() {
            const previewImg = document.getElementById('previewImg');
            const uploadArea = document.getElementById('uploadArea');
            const imagePreview = document.getElementById('imagePreview');
            const imageUpload = document.getElementById('imageUpload');
            
            previewImg.src = '';
            imageUpload.value = '';
            uploadArea.classList.remove('hidden');
            imagePreview.classList.add('hidden');
        }

        function updateScheduledPosts() {
            const container = document.getElementById('scheduledPosts');
            const dayPosts = scheduledPosts.filter(post => 
                new Date(post.date).toDateString() === selectedDate.toDateString()
            );
            
            if (dayPosts.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-8">No posts scheduled for this date</p>';
                return;
            }
            
            container.innerHTML = dayPosts.map(post => {
                const postAccounts = post.accounts.map(accountId => 
                    connectedAccounts.find(acc => acc.id == accountId)
                ).filter(Boolean);
                
                return `
                    <div class="post-item border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                        <div class="flex items-start justify-between mb-3">
                            <div class="flex items-center space-x-2">
                                <span class="text-sm font-medium text-gray-600">
                                    ${new Date(post.date).toLocaleTimeString('en-US', { 
                                        hour: '2-digit', 
                                        minute: '2-digit' 
                                    })}
                                </span>
                                <span class="px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full">
                                    ${post.type}
                                </span>
                            </div>
                            <div class="flex items-center space-x-2">
                                ${isToday(post.date) ? `
                                    <button onclick="postNow(${post.id})" class="bg-purple-400 hover:bg-purple-500 text-black px-3 py-1 rounded text-sm transition-colors">
                                        Post Now
                                    </button>
                                ` : ''}
                                <button onclick="editPost(${post.id})" class="text-blue-600 hover:text-blue-800 text-sm">
                                    Edit
                                </button>
                                <button onclick="deletePost(${post.id})" class="text-red-600 hover:text-red-800 text-sm">
                                    Delete
                                </button>
                            </div>
                        </div>
                        ${post.image ? `
                            <div class="mb-3">
                                <img src="${post.image}" alt="Post image" class="w-full h-48 object-cover rounded-lg">
                            </div>
                        ` : ''}
                        <p class="text-gray-800 mb-3">${post.content.substring(0, 150)}${post.content.length > 150 ? '...' : ''}</p>
                        <div class="flex items-center space-x-2">
                            <span class="text-sm text-gray-600">Accounts:</span>
                            ${postAccounts.map(account => `
                                <span class="px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded flex items-center space-x-1">
                                    <span>${getPlatformIcon(account.platform)}</span>
                                    <span>${account.handle}</span>
                                </span>
                            `).join('')}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateTodaysSchedule() {
            const container = document.getElementById('todaysSchedule');
            const today = new Date().toDateString();
            const todaysPosts = scheduledPosts.filter(post => 
                new Date(post.date).toDateString() === today
            );
            
            if (todaysPosts.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-sm">No posts scheduled for today</p>';
                return;
            }
            
            container.innerHTML = todaysPosts.map(post => {
                const postAccounts = post.accounts.map(accountId => 
                    connectedAccounts.find(acc => acc.id == accountId)
                ).filter(Boolean);
                
                return `
                    <div class="border border-gray-200 rounded-lg p-3">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-medium">
                                ${new Date(post.date).toLocaleTimeString('en-US', { 
                                    hour: '2-digit', 
                                    minute: '2-digit' 
                                })}
                            </span>
                            <button onclick="postNow(${post.id})" class="bg-purple-400 hover:bg-purple-500 text-black px-2 py-1 rounded text-xs transition-colors">
                                Post Now
                            </button>
                        </div>
                        <p class="text-sm text-gray-700 mb-2">${post.content.substring(0, 80)}...</p>
                        <div class="flex space-x-1">
                            ${postAccounts.map(account => `
                                <span class="text-xs">${getPlatformIcon(account.platform)}</span>
                            `).join('')}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function postNow(postId) {
            const post = scheduledPosts.find(p => p.id === postId);
            if (!post) return;
            
            const postAccounts = post.accounts.map(accountId => 
                connectedAccounts.find(acc => acc.id == accountId)
            ).filter(Boolean);
            
            const modal = document.getElementById('postNowModal');
            const accountsContainer = document.getElementById('postNowAccounts');
            
            accountsContainer.innerHTML = postAccounts.map(account => `
                <button onclick="publishToAccount('${account.platform}', '${account.handle}', ${postId})" 
                        class="w-full bg-${getPlatformColor(account.platform)}-600 hover:bg-${getPlatformColor(account.platform)}-700 text-white py-3 px-4 rounded-lg font-medium transition-colors flex items-center justify-center space-x-2">
                    <span>${getPlatformIcon(account.platform)}</span>
                    <span>Post to ${account.handle}</span>
                </button>
            `).join('');
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function publishToAccount(platform, handle, postId) {
            const post = scheduledPosts.find(p => p.id === postId);
            
            // Platform-specific URLs for posting
            const platformUrls = {
                linkedin: 'https://www.linkedin.com/sharing/share-offsite/',
                twitter: 'https://twitter.com/intent/tweet',
                instagram: 'https://www.instagram.com/',
                facebook: 'https://www.facebook.com/sharer/sharer.php',
                tiktok: 'https://www.tiktok.com/upload'
            };
            
            const encodedContent = encodeURIComponent(post.content);
            let url = platformUrls[platform];
            
            if (platform === 'twitter') {
                url += `?text=${encodedContent}`;
            } else if (platform === 'linkedin' || platform === 'facebook') {
                url += `?url=${encodeURIComponent(window.location.href)}&summary=${encodedContent}`;
            }
            
            // Open platform in new window for manual posting
            window.open(url, '_blank', 'width=600,height=400');
            
            // Mark as posted
            post.status = 'posted';
            localStorage.setItem('scheduledPosts', JSON.stringify(scheduledPosts));
            
            alert(`Opening ${platform} for ${handle}. Complete the post manually in the new window.`);
            closePostNow();
            updateScheduledPosts();
            updateTodaysSchedule();
        }

        function closePostNow() {
            document.getElementById('postNowModal').classList.add('hidden');
            document.getElementById('postNowModal').classList.remove('flex');
        }

        function deletePost(postId) {
            if (confirm('Are you sure you want to delete this post?')) {
                scheduledPosts = scheduledPosts.filter(post => post.id !== postId);
                localStorage.setItem('scheduledPosts', JSON.stringify(scheduledPosts));
                generateCalendar();
                updateScheduledPosts();
                updateTodaysSchedule();
            }
        }

        // Utility functions
        function isToday(dateString) {
            return new Date(dateString).toDateString() === new Date().toDateString();
        }

        function getPlatformColor(platform) {
            const colors = {
                linkedin: 'blue',
                twitter: 'blue',
                instagram: 'pink',
                facebook: 'blue',
                tiktok: 'black'
            };
            return colors[platform] || 'gray';
        }

        function getPlatformIcon(platform) {
            const icons = {
                linkedin: 'üíº',
                twitter: 'üê¶',
                instagram: 'üì∑',
                facebook: 'üë•',
                tiktok: 'üéµ'
            };
            return icons[platform] || 'üì±';
        }

        function showTodaysPosts() {
            const today = new Date();
            selectDate(today);
        }

        function togglePlatform(platform) {
            alert(`${platform.charAt(0).toUpperCase() + platform.slice(1)} integration active. Posts will open in new window for manual publishing.`);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'973499bc7763af1c',t:'MTc1NTg4OTA5NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

